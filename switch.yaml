- platform: template
  switches:
    bedroomtoggle:
      value_template: "{{ is_state('light.desk_lights', 'on') }}"
      turn_on:
        - service: script.stuff_on
      turn_off:
        - service: script.turn_on
          target:
            entity_id:
              - script.stuff_off
              - script.ac_off
    vizio_tv:
      friendly_name: Bedroom TV
      value_template: "{{ states('sensor.tv_plug_wattage')|float > 10 }}"
      turn_on:
        - service: remote.send_command
          data:
            entity_id: remote.bedroom_rm4_remote
            command: turn on
            device: vizio
        - delay: 8
        - service: homeassistant.update_entity
          entity_id: sensor.tv_plug_wattage
      turn_off:
        - service: remote.send_command
          data:
            entity_id: remote.bedroom_rm4_remote
            command: turn off
            device: vizio
        - delay: 8
        - service: homeassistant.update_entity
          entity_id: sensor.tv_plug_wattage
    ac:
      friendly_name: Air Conditioner
      value_template: "{{ states('sensor.ac_plug_wattage')|float > 7 }}"
      turn_on:
        - service: remote.send_command
          data:
            entity_id: remote.bedroom_rm4_remote
            command: power
            device: ac
        - delay: 4
        - service: homeassistant.update_entity
          entity_id: sensor.ac_plug_wattage
      turn_off:
        - service: remote.send_command
          data:
            entity_id: remote.bedroom_rm4_remote
            command: power
            device: ac
        - delay: 8
        - service: homeassistant.update_entity
          entity_id: sensor.ac_plug_wattage
    windows:
      friendly_name: Desktop
      value_template: "{{ states('sensor.monitor_plug_wattage')|float > 6 }}"
      turn_on:
        - service: mqtt.publish
          data:
            topic: "iotlink/workgroup/desktop-pc/commands/displays/on"
            payload: ""  
        - service: mqtt.publish
          data:
            topic: "iotlink/workgroup/desktop-pc/commands/run"
            payload: '{"command": "C:\\Windows\\explorer.exe", "path": "C:\\Windows\\", "args": "C:\\Homebridge\\stuffonsilent.lnk", "user": "", "visible": "false", "fallback": "true"}'
        - delay: 13
        - service: homeassistant.update_entity
          entity_id: sensor.monitor_plug_wattage
      turn_off:
        - service: mqtt.publish
          data:
            topic: "iotlink/workgroup/desktop-pc/commands/run"
            payload: '{"command": "C:\\Windows\\explorer.exe", "path": "C:\\Windows\\", "args": "C:\\Homebridge\\offsilent.lnk", "user": "", "visible": "false", "fallback": "true"}'
        - delay: 18
        - service: homeassistant.update_entity
          entity_id: sensor.monitor_plug_wattage
    living_room_tv:
      friendly_name: Living Room TV
      value_template: "{{ is_state('media_player.living_room_denon', 'playing') or is_state('media_player.living_room_denon', 'on')}}"
      turn_on:
        - service: remote.send_command
          data:
            entity_id: remote.living_room_remote
            command: turn on
            device: vizio
        - service: media_player.turn_on
          data:
            entity_id: media_player.living_room_denon
      turn_off:
        - service: remote.send_command
          data:
            entity_id: remote.living_room_remote
            command: turn off
            device: vizio
        - service: media_player.turn_off
          data:
            entity_id: media_player.living_room_denon