esphome:
  name: bedscale
  platform: ESP8266
  board: d1_mini

wifi:
  ssid: !secret ssid
  password: !secret password
  fast_connect: on
  ap: {}
  power_save_mode: none

captive_portal:
logger:
api:
ota:

sensor:
  - platform: hx711
    name: "Bed Weight"
    id: bed_weight
    dout_pin: D4
    clk_pin: RX
    filters:
      - delta: 1500
      - calibrate_linear:
          - 350000 -> 0
          - 470000 -> 300
#      - sliding_window_moving_average:
#          window_size: 5
#          send_every: 3
      - lambda: |-
          if (x >= 0) return x;
          else return {};
      - lambda: |-
          if (x <= 500) return x;
          else return {};
    update_interval: .5s
    unit_of_measurement: lbs
    accuracy_decimals: 0
    
binary_sensor:
  - platform: template
    name: "Bed Occupancy"
    device_class: occupancy
    lambda: |-
      if (id(bed_weight).state > 120) {
        return true;
      } else {
        return false;
      }      